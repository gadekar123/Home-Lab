name: Configuration Guardian

on: [push, pull_request]

jobs:
  nginx-validate:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - name: Validate Nginx Config
        run: |
          docker run --rm \
            -v ${{ github.workspace }}/media-stack/nginx/conf.d:/etc/nginx/conf.d:ro \
            nginx:alpine nginx -t

  prometheus-validate:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - name: Validate Prometheus Config
        run: |
          docker run --rm \
            -v ${{ github.workspace }}/monitoring/prometheus.yml:/etc/prometheus/prometheus.yml:ro \
            prom/prometheus:latest \
            --config.file=/etc/prometheus/prometheus.yml \
            --check-config
